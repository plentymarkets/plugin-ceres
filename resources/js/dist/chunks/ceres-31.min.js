(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{375:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 col-sm-6 mb-2"},[a("button",{staticClass:"btn btn-primary btn-appearance btn-block",attrs:{type:"button","data-toggle":"modal","data-target":"#edit-coupon-overlay"}},[a("span",[t._v(t._s(t.$translate("Ceres::Template.couponEdit")))]),t._v(" "),a("i",{staticClass:"fa fa-gift default-float",attrs:{"aria-hidden":"true"}})])]),t._v(" "),a("div",{staticClass:"col-12 col-sm-6 mb-2"},[t.isFinalized?t._e():a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:!t.isPaid,expression:"!isPaid"}],staticClass:"btn btn-success btn-block",class:{disabled:t.isLoading||!t.isPaid},attrs:{type:"button","data-placement":"top",title:t.$translate("Ceres::Template.couponNotPaid")},on:{click:function(e){return t.finalize()}}},[a("span",[t._v(t._s(t.$translate("Ceres::Template.couponFinalize")))]),t._v(" "),a("icon",{staticClass:"default-float",attrs:{icon:"check",loading:t.isLoading}})],1),t._v(" "),t.isFinalized&&t.isPaid?a("a",{staticClass:"btn btn-primary btn-appearance btn-block",attrs:{href:t.pdfLink,target:"_blank",title:"$translate('Ceres::Template.couponDownload')"}},[a("span",[t._v(t._s(t.$translate("Ceres::Template.couponDownload")))]),t._v(" "),a("i",{staticClass:"fa fa-download default-float",attrs:{"aria-hidden":"true"}})]):t._e()])]),t._v(" "),a("form",{attrs:{method:"post"},on:{submit:function(e){return e.preventDefault(),t.submit()}}},[a("div",{ref:"editCouponOverlay",staticClass:"modal fade",attrs:{id:"edit-coupon-overlay",tabindex:"-1",role:"dialog"}},[a("div",{staticClass:"modal-dialog modal-lg mx-auto modal-dialog-scrollable",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("div",{staticClass:"modal-title h4"},[t._v(t._s(t.$translate("Ceres::Template.couponEdit")))]),t._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"},on:{click:function(e){return t.closeModal()}}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("Ã—")])])]),t._v(" "),a("div",{staticClass:"modal-body overflow-x-hidden modal-multi-row"},[t._l(t.couponData,(function(e){return[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 h5"},[t._v("Gutschein")]),t._v(" "),a("div",{staticClass:"col-6"},[a("div",{staticClass:"input-unit"},[a("input",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.isFinalized,expression:"isFinalized"},{name:"model",rawName:"v-model",value:e.sender,expression:"coupon.sender"}],class:{disabled:t.isLoading||t.isFinalized},attrs:{readonly:t.isFinalized,"data-placement":"top",title:t.$translate("Ceres::Template.couponAlreadyFinalized"),type:"text",name:"sender",autocomplete:"off","data-validate":"text","data-autofocus":""},domProps:{value:e.sender},on:{input:function(a){a.target.composing||t.$set(e,"sender",a.target.value)}}}),t._v(" "),a("label",{attrs:{for:"sender"}},[t._v(t._s(t.$translate("Ceres::Template.couponSender"))+"*")])])]),t._v(" "),a("div",{staticClass:"col-6"},[a("div",{staticClass:"input-unit"},[a("input",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.isFinalized,expression:"isFinalized"},{name:"model",rawName:"v-model",value:e.recipient,expression:"coupon.recipient"}],class:{disabled:t.isLoading||t.isFinalized},attrs:{readonly:t.isFinalized,"data-placement":"top",title:t.$translate("Ceres::Template.couponAlreadyFinalized"),type:"text",name:"recipient",autocomplete:"off","data-validate":"text"},domProps:{value:e.recipient},on:{input:function(a){a.target.composing||t.$set(e,"recipient",a.target.value)}}}),t._v(" "),a("label",{attrs:{for:"recipient"}},[t._v(t._s(t.$translate("Ceres::Template.couponRecipient"))+"*")])])]),t._v(" "),a("div",{staticClass:"col-12"},[a("div",{staticClass:"input-unit"},[a("textarea",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.isFinalized,expression:"isFinalized"},{name:"model",rawName:"v-model",value:e.content,expression:"coupon.content"}],class:{disabled:t.isLoading||t.isFinalized},attrs:{readonly:t.isFinalized,"data-placement":"top",title:t.$translate("Ceres::Template.couponAlreadyFinalized"),name:"content",rows:"3",autocomplete:"off"},domProps:{value:e.content},on:{input:function(a){a.target.composing||t.$set(e,"content",a.target.value)}}}),t._v(" "),a("label",{attrs:{for:"content"}},[t._v(t._s(t.$translate("Ceres::Template.couponContent")))])])])])]}))],2),t._v(" "),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-danger",attrs:{type:"reset",disabled:t.isLoading,"data-dismiss":"modal","aria-label":"Close"},on:{click:function(e){return t.closeModal()}}},[a("span",[t._v(t._s(t.$translate("Ceres::Template.couponCancel")))]),t._v(" "),a("i",{staticClass:"fa fa-times default-float",attrs:{"aria-hidden":"true"}})]),t._v(" "),a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.isFinalized,expression:"isFinalized"}],staticClass:"btn btn-primary",class:{disabled:t.isLoading||t.isFinalized},attrs:{type:"submit","data-placement":"top",title:t.$translate("Ceres::Template.couponAlreadyFinalized")}},[a("span",[t._v(t._s(t.$translate("Ceres::Template.couponSave")))]),t._v(" "),a("icon",{staticClass:"default-float",attrs:{icon:"floppy-o",loading:t.isLoading}})],1)])])])])])])};i._withStripped=!0;var s=a(21),o=a(110),n=a(6),r={props:{orderItem:Object,paymentStatus:{type:String,default:"unpaid"},orderAccessKey:{type:String,default:""}},data:function(){return{couponData:[],isFinalized:this.orderItem.giftCard.hasPdf,isLoading:!1}},computed:{pdfLink:function(){var t="/rest/online_store/gift_card/download_pdf/?orderId="+this.orderItem.orderId+"&orderItemId="+this.orderItem.id;return this.orderAccessKey&&(t+="&accessKey="+this.orderAccessKey),t},isPaid:function(){return"fullyPaid"===this.paymentStatus}},created:function(){for(var t=0;t<this.orderItem.quantity;t++)this.couponData.push({sender:this.orderItem.giftCard.information[t].sender,recipient:this.orderItem.giftCard.information[t].recipient,content:this.orderItem.giftCard.information[t].content,campaignCodeOrderId:this.orderItem.giftCard.information[t].id,accessKey:this.orderAccessKey})},methods:{submit:function(){var t=this;this.isFinalized||(this.isLoading=!0,n.put("/rest/online_store/gift_card/information",{giftCardInformation:this.couponData}).done((function(e){s.default.success(t.$translate("Ceres::Template.couponChangeSuccess")),t.closeModal()})).fail((function(){s.default.error(t.$translate("Ceres::Template.couponChangeFailure")).closeAfter(1e4)})).always((function(){t.isLoading=!1})))},finalize:function(){var t=this;this.isPaid&&(this.isLoading=!0,n.post("/rest/online_store/gift_card/generate_pdf",{orderId:this.orderItem.orderId,orderItemId:this.orderItem.id,accessKey:this.orderAccessKey}).done((function(e){s.default.success(t.$translate("Ceres::Template.couponFinalizeSuccess")),t.isFinalized=!0})).fail((function(){s.default.error(t.$translate("Ceres::Template.couponFinalizeFailure")).closeAfter(1e4)})).always((function(){t.isLoading=!1})))},download:function(){var t=this;this.isLoading=!0,n.get("/rest/online_store/gift_card/download_pdf",{orderId:this.orderItem.orderId,orderItemId:this.orderItem.id,accessKey:this.orderAccessKey}).done((function(e){s.default.success(t.$translate("Ceres::Template.couponFinalizeSuccess"))})).fail((function(){s.default.error(t.$translate("Ceres::Template.couponFinalizeFailure")).closeAfter(1e4)})).always((function(){t.isLoading=!1}))},closeModal:function(){o.findModal(this.$refs.editCouponOverlay).hide()}}},l=a(8),d=Object(l.a)(r,i,[],!1,null,null,null);d.options.__file="resources/js/src/app/components/item/EditCouponOverlay.vue";e.default=d.exports}}]);
//# sourceMappingURL=ceres-31.min.js.map