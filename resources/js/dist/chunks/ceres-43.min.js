(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{363:function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"pb-3"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-12 col-sm-6"},[e("button",{staticClass:"btn btn-primary btn-appearance btn-block coupon-edit",attrs:{type:"button","data-toggle":"modal","data-target":"#edit-coupon-overlay-"+t._uid}},[e("span",[t._v(t._s(t.$translate("Ceres::Template.couponEdit")))]),t._v(" "),e("i",{staticClass:"fa fa-gift default-float",attrs:{"aria-hidden":"true"}})])]),t._v(" "),e("div",{staticClass:"col-12 col-sm-6"},[t.isFinalized?t._e():e("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:!t.isPaid,expression:"!isPaid"}],staticClass:"btn btn-primary btn-appearance btn-block coupon-create",class:{disabled:t.isLoading||!t.isPaid},attrs:{type:"button","data-placement":"top",title:t.$translate("Ceres::Template.couponNotPaid")},on:{click:function(a){return t.openConfirmModal()}}},[e("span",[t._v(t._s(t.$translate("Ceres::Template.couponFinalize")))]),t._v(" "),e("i",{staticClass:"fa fa-check default-float",attrs:{"aria-hidden":"true"}})]),t._v(" "),t.isFinalized&&t.isPaid?e("a",{staticClass:"btn btn-primary btn-appearance btn-block coupon-download",attrs:{href:t.pdfLink,target:"_blank",title:t.$translate("Ceres::Template.couponDownload")}},[e("span",[t._v(t._s(t.$translate("Ceres::Template.couponDownload")))]),t._v(" "),e("i",{staticClass:"fa fa-download default-float",attrs:{"aria-hidden":"true"}})]):t._e()])]),t._v(" "),e("form",{attrs:{method:"post"},on:{submit:function(a){return a.preventDefault(),t.submit()}}},[e("div",{ref:"editCouponOverlay",staticClass:"modal fade",attrs:{id:"edit-coupon-overlay-"+t._uid,tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog modal-lg mx-auto modal-dialog-scrollable",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("div",{staticClass:"modal-title h4"},[t._v(t._s(t.$translate("Ceres::Template.couponEdit")))]),t._v(" "),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"},on:{click:function(a){return t.closeEditModal()}}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),t._v(" "),e("div",{staticClass:"modal-body overflow-x-hidden modal-multi-row"},[t._l(t.couponData,(function(a){return[e("div",{staticClass:"row"},[e("div",{staticClass:"col-12 h5"},[t._v(t._s(t.$translate("Ceres::Template.couponLabel")))]),t._v(" "),e("div",{staticClass:"col-12 col-sm-6"},[e("div",{staticClass:"input-unit"},[e("input",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.isFinalized,expression:"isFinalized"},{name:"model",rawName:"v-model",value:a.sender,expression:"coupon.sender"}],class:{disabled:t.isLoading||t.isFinalized},attrs:{readonly:t.isFinalized,"data-placement":"top",title:t.$translate("Ceres::Template.couponAlreadyFinalized"),type:"text",name:"sender",autocomplete:"off","data-validate":"text","data-autofocus":""},domProps:{value:a.sender},on:{input:function(e){e.target.composing||t.$set(a,"sender",e.target.value)}}}),t._v(" "),e("label",{attrs:{for:"sender"}},[t._v(t._s(t.$translate("Ceres::Template.couponSender"))+"*")])])]),t._v(" "),e("div",{staticClass:"col-12 col-sm-6"},[e("div",{staticClass:"input-unit"},[e("input",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.isFinalized,expression:"isFinalized"},{name:"model",rawName:"v-model",value:a.recipient,expression:"coupon.recipient"}],class:{disabled:t.isLoading||t.isFinalized},attrs:{readonly:t.isFinalized,"data-placement":"top",title:t.$translate("Ceres::Template.couponAlreadyFinalized"),type:"text",name:"recipient",autocomplete:"off","data-validate":"text"},domProps:{value:a.recipient},on:{input:function(e){e.target.composing||t.$set(a,"recipient",e.target.value)}}}),t._v(" "),e("label",{attrs:{for:"recipient"}},[t._v(t._s(t.$translate("Ceres::Template.couponRecipient"))+"*")])])]),t._v(" "),e("div",{staticClass:"col-12"},[e("div",{staticClass:"input-unit"},[e("textarea",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.isFinalized,expression:"isFinalized"},{name:"model",rawName:"v-model",value:a.content,expression:"coupon.content"}],class:{disabled:t.isLoading||t.isFinalized},attrs:{readonly:t.isFinalized,"data-placement":"top",title:t.$translate("Ceres::Template.couponAlreadyFinalized"),name:"content",rows:"3",autocomplete:"off"},domProps:{value:a.content},on:{input:function(e){e.target.composing||t.$set(a,"content",e.target.value)}}}),t._v(" "),e("label",{attrs:{for:"content"}},[t._v(t._s(t.$translate("Ceres::Template.couponContent")))])])])])]}))],2),t._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-danger",attrs:{type:"button",disabled:t.isLoading,"data-dismiss":"modal","aria-label":"Close"},on:{click:function(a){return t.closeEditModal()}}},[e("span",[t._v(t._s(t.$translate("Ceres::Template.couponCancel")))]),t._v(" "),e("i",{staticClass:"fa fa-times default-float",attrs:{"aria-hidden":"true"}})]),t._v(" "),e("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.isFinalized,expression:"isFinalized"}],staticClass:"btn btn-primary",class:{disabled:t.isLoading||t.isFinalized},attrs:{type:"submit","data-placement":"top",title:t.$translate("Ceres::Template.couponAlreadyFinalized")}},[e("span",[t._v(t._s(t.$translate("Ceres::Template.couponSave")))]),t._v(" "),e("icon",{staticClass:"default-float",attrs:{icon:"check",loading:t.isLoading}})],1)])])])])]),t._v(" "),e("div",{ref:"confirmFinalizationOverlay",staticClass:"modal fade",attrs:{id:"confirm-finalization-overlay",tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("div",{staticClass:"modal-title h4"},[t._v(t._s(t.$translate("Ceres::Template.couponFinalize")))]),t._v(" "),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"},on:{click:function(a){return t.closeConfirmModal()}}},[e("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),t._v(" "),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"my-2"},[t._v(t._s(t.$translate("Ceres::Template.couponFinalizeConfirm")))])]),t._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-danger",attrs:{type:"button",disabled:t.isFinalizing,"data-dismiss":"modal","aria-label":"Close"},on:{click:function(a){return t.closeConfirmModal()}}},[e("span",[t._v(t._s(t.$translate("Ceres::Template.couponFinalizeConfirmNo")))]),t._v(" "),e("i",{staticClass:"fa fa-times default-float",attrs:{"aria-hidden":"true"}})]),t._v(" "),e("button",{staticClass:"btn btn-primary",class:{disabled:t.isFinalizing},attrs:{type:"button"},on:{click:function(a){return t.finalize()}}},[e("span",[t._v(t._s(t.$translate("Ceres::Template.couponFinalizeConfirmYes")))]),t._v(" "),e("icon",{staticClass:"default-float",attrs:{icon:"check",loading:t.isFinalizing}})],1)])])])])])};i._withStripped=!0;var s=e(16),n=e(95),o=e(7),l={props:{orderItem:Object,paymentStatus:{type:String,default:"unpaid"},orderAccessKey:{type:String,default:""}},data:function(){return{couponData:[],isFinalized:this.orderItem.giftCard.hasPdf,isLoading:!1,isFinalizing:!1}},computed:{pdfLink:function(){var t="/rest/online_store/gift_card/download_pdf/?orderId="+this.orderItem.orderId+"&orderItemId="+this.orderItem.id;return this.orderAccessKey&&(t+="&accessKey="+this.orderAccessKey),t},isPaid:function(){return"fullyPaid"===this.paymentStatus||"overpaid"===this.paymentStatus}},created:function(){for(var t=0;t<this.orderItem.quantity;t++)this.couponData.push({sender:this.orderItem.giftCard.information[t].sender,recipient:this.orderItem.giftCard.information[t].recipient,content:this.orderItem.giftCard.information[t].content,campaignCodeOrderId:this.orderItem.giftCard.information[t].id,accessKey:this.orderAccessKey})},methods:{submit:function(){var t=this;this.isFinalized||this.isLoading||(this.isLoading=!0,o.default.put("/rest/online_store/gift_card/information",{giftCardInformation:this.couponData}).done((function(a){s.default.success(t.$translate("Ceres::Template.couponChangeSuccess")).closeAfter(3e3)})).fail((function(){s.default.error(t.$translate("Ceres::Template.couponChangeFailure")).closeAfter(1e4)})).always((function(){t.closeEditModal(),t.isLoading=!1})))},finalize:function(){var t=this;!this.isPaid||this.isLoading||this.isFinalizing||(this.isFinalizing=!0,o.default.post("/rest/online_store/gift_card/generate_pdf",{orderId:this.orderItem.orderId,orderItemId:this.orderItem.id,accessKey:this.orderAccessKey}).done((function(a){s.default.success(t.$translate("Ceres::Template.couponFinalizeSuccess")).closeAfter(3e3),window.open(t.pdfLink,"_blank"),t.isFinalized=!0})).fail((function(){s.default.error(t.$translate("Ceres::Template.couponFinalizeFailure")).closeAfter(1e4)})).always((function(){t.closeConfirmModal(),t.isFinalizing=!1})))},openConfirmModal:function(){this.isPaid&&n.default.findModal(this.$refs.confirmFinalizationOverlay).show()},closeEditModal:function(){n.default.findModal(this.$refs.editCouponOverlay).hide()},closeConfirmModal:function(){n.default.findModal(this.$refs.confirmFinalizationOverlay).hide()}}},r=e(8),d=Object(r.a)(l,i,[],!1,null,null,null);d.options.__file="resources/js/src/app/components/myAccount/EditCouponOverlay.vue";a.default=d.exports}}]);
//# sourceMappingURL=ceres-43.min.js.map