(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{357:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("form",{ref:"registrationForm",staticClass:"w-100",attrs:{autocomplete:"on",method:"post"},on:{submit:function(t){return t.preventDefault(),e.validateRegistration()}}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-12"},[a("div",{staticClass:"input-unit",attrs:{"data-validate":"mail"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{"data-testing":"mail-register",type:"email",name:"email",autocomplete:"email",id:"email"+e._uid,"data-autofocus":""},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}}),e._v(" "),a("label",{attrs:{for:"email"+e._uid}},[e._v(e._s(e.$translate("Ceres::Template.regEmail"))+"*")])])]),e._v(" "),e.guestMode?e._e():a("div",{staticClass:"col-sm-6"},[a("div",{ref:"passwordInput",staticClass:"input-unit",class:{"no-bottom media-xs-d":e.modalElement},attrs:{"data-validate":"password"}},[a("popper",{ref:"passwordHint",attrs:{trigger:"focus",placement:"bottom"},scopedSlots:e._u([{key:"handle",fn:function(){return[a("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{"data-testing":"password-register",type:"password",name:"password",autocomplete:"new-password",id:"new-password-"+e._uid},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}})]},proxy:!0},{key:"title",fn:function(){return[a("div",[e._v("\n                            "+e._s(e.$translate("Ceres::Template.regPasswordHintTitle"))+"\n                        ")])]},proxy:!0},{key:"content",fn:function(){return[a("ul",{staticClass:"pl-3"},[a("li",[e._v(e._s(e.$translate("Ceres::Template.regPasswordHintLength")))]),e._v(" "),a("li",[e._v(e._s(e.$translate("Ceres::Template.regPasswordHintDigit")))]),e._v(" "),a("li",[e._v(e._s(e.$translate("Ceres::Template.regPasswordHintChar")))])])]},proxy:!0}],null,!1,303377206)}),e._v(" "),a("label",{attrs:{for:"new-password-"+e._uid}},[e._v(e._s(e.$translate("Ceres::Template.regPassword"))+"*")])],1)]),e._v(" "),e.guestMode?e._e():a("div",{staticClass:"col-sm-6 input-unit-group"},[a("div",{staticClass:"input-unit",class:{"no-bottom":e.modalElement},attrs:{"data-validate":"ref"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.passwordRepeat,expression:"passwordRepeat"}],attrs:{type:"password",name:"password-repeat",autocomplete:"new-password",id:"new-password-repeat-"+e._uid,"data-validate-ref":"#new-password-"+e._uid,"data-testing":"repeat-password-register"},domProps:{value:e.passwordRepeat},on:{input:function(t){t.target.composing||(e.passwordRepeat=t.target.value)}}}),e._v(" "),a("label",{attrs:{for:"new-password-repeat-"+e._uid}},[e._v(e._s(e.$translate("Ceres::Template.regRepeatPassword"))+"*")])])]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.honeypot,expression:"honeypot"}],staticClass:"honey",attrs:{type:"text",name:"username",autocomplete:"new-password",tabindex:"-1"},domProps:{value:e.honeypot},on:{input:function(t){t.target.composing||(e.honeypot=t.target.value)}}}),e._v(" "),a("div",{staticClass:"col-12"},[e.isSimpleRegistration?e._e():a("address-input-group",{attrs:{template:"#vue-address-input-group","address-type":"1",value:e.billingAddress,"optional-address-fields":e.shownFields,"required-address-fields":e.requiredFields,"default-salutation":e.defaultSalutation},on:{input:function(t){return e.setAddressDataField(t)}},scopedSlots:e._u([{key:"custom-address-fields",fn:function(){return[e._t("custom-address-fields")]},proxy:!0}],null,!0)})],1),e._v(" "),e.enableConfirmingPrivacyPolicy?a("div",{staticClass:"col-12"},[a("accept-privacy-policy-check",{staticClass:"mt-3 mb-0",attrs:{"show-error":e.privacyPolicyShowError},on:{input:function(t){return e.privacyPolicyValueChanged(t)}},model:{value:e.privacyPolicyAccepted,callback:function(t){e.privacyPolicyAccepted=t},expression:"privacyPolicyAccepted"}})],1):e._e()]),e._v(" "),a("div",{staticClass:"border-top mt-2 text-right"},[e._t("extend-overlay-buttons"),e._v(" "),a("button",{staticClass:"btn btn-appearance btn-primary btn-medium mt-3",class:e.buttonSizeClass,attrs:{disabled:e.isDisabled,"data-testing":"register-submit"}},[e._v("\n            "+e._s(e.$translate("Ceres::Template.regRegister"))+"\n            "),a("icon",{staticClass:"default-float",attrs:{icon:"user-plus",loading:e.isDisabled}})],1)],2),e._v(" "),!e.googleRecaptchaApiKey||!e.modalShown&&e.isSimpleRegistration?e._e():a("recaptcha")],1)};r._withStripped=!0;a(47),a(53),a(66),a(16),a(94),a(5),a(13),a(20),a(11),a(6),a(14),a(15),a(10),a(12);var s=a(29),n=a(27),i=a(148),o=a(1),l=a(153),c=a(211),d=a(7),p=a(9),u=a(56),m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"form-check",class:{error:e.showError}},[a("input",{staticClass:"form-check-input",attrs:{type:"checkbox",id:"privacy-policy-accept"+e._uid,"data-testing":"privacy-policy-accept-register"},domProps:{checked:e.value},on:{change:function(t){return e.onValueChanged(t.target.checked)}}}),e._v(" "),a("label",{staticClass:"form-check-label",attrs:{for:"privacy-policy-accept"+e._uid}},[a("span",{domProps:{innerHTML:e._s(e.labelHtml)}}),a("sup",[e._v("*")])])])};m._withStripped=!0;a(41);var f={name:"accept-privacy-policy-check",props:{value:Boolean,showError:Boolean},computed:{labelHtml:function(){var e=this.$translate("Ceres::Template.contactPrivacyPolicy",{hyphen:"&shy;"}),t='\n                \x3c!----\x3e<a href="'.concat(App.urls.privacyPolicy,'" target="_blank" class="text-appearance">\n                    <span>').concat(e,"</span>\n                </a>\x3c!----\x3e\n            ");return this.$translate("Ceres::Template.contactAcceptPrivacyPolicy",{policy:t})}},methods:{onValueChanged:function(e){this.$emit("input",e)}}},v=a(3),y=Object(v.a)(f,m,[],!1,null,null,null);y.options.__file="resources/js/src/app/components/customer/AcceptPrivacyPolicyCheck.vue";var h=y.exports;function g(e,t){var a;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return w(e,t)}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var r=0,s=function(){};return{s:s,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,i=!0,o=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return i=e.done,e},e:function(e){o=!0,n=e},f:function(){try{i||null==a.return||a.return()}finally{if(o)throw n}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var b={name:"registration",components:{AddressInputGroup:c.a,AcceptPrivacyPolicyCheck:h},mixins:[l.a],props:{modalElement:String,guestMode:{type:Boolean,default:!1},isSimpleRegistration:{type:Boolean,default:!1},template:String,backlink:String,shownFields:Object,requiredFields:Object,defaultSalutation:{type:String,default:App.config.addresses.defaultSalutation}},data:function(){return{password:"",passwordRepeat:"",username:"",billingAddress:{countryId:null,stateId:null,gender:this.defaultSalutation},isDisabled:!1,privacyPolicyAccepted:!1,privacyPolicyShowError:!1,enableConfirmingPrivacyPolicy:App.config.global.registrationRequirePrivacyPolicyConfirmation,googleRecaptchaApiKey:App.config.global.googleRecaptchaApiKey,modalShown:!1,honeypot:""}},mounted:function(){var e=this;this.$nextTick((function(){e.modalElement&&e.initModalEventListeners()}))},methods:{validateRegistration:function(){var e=this;Object(i.a)(this.$refs.registrationForm).then((function(t){s.default.validate(e.$refs.registrationForm).done((function(){!e.enableConfirmingPrivacyPolicy||e.privacyPolicyAccepted?e.sendRegistration(t):(e.privacyPolicyShowError=!0,p.default.error(e.$translate("Ceres::Template.contactAcceptFormPrivacyPolicy",{hyphen:"&shy;"})),e.resetRecaptcha())})).fail((function(t){e.resetRecaptcha(),!Object(o.e)(e.$refs.passwordHint)&&t.indexOf(e.$refs.passwordInput)>=0&&e.$refs.passwordHint.showPopper();var a=e.getInvalidFieldNames(t);a.length>0&&p.default.error(e.$translate("Ceres::Template.checkoutCheckAddressFormFields",{fields:a.join(", ")})),s.default.markInvalidFields(t,"error"),e.enableConfirmingPrivacyPolicy&&!e.privacyPolicyAccepted&&(e.privacyPolicyShowError=!0,p.default.error(e.$translate("Ceres::Template.contactAcceptFormPrivacyPolicy",{hyphen:"&shy;"})))}))}))},getInvalidFieldNames:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=[],r=g(t);try{for(r.s();!(e=r.n()).done;){var s=e.value,n=s.lastElementChild.innerHTML.trim();n="*"===n.slice(-1)?n.slice(0,n.length-1):n,a.push(n)}}catch(e){r.e(e)}finally{r.f()}return a},sendRegistration:function(e){var t=this,a=this.getUserObject();a.recaptcha=e,this.isDisabled=!0,d.default.post("/rest/io/customer",a).done((function(e){d.default.setToken(e),e.code?(p.default.error(t.$translate("Ceres::Template.regError")).closeAfter(1e4),t.resetRecaptcha()):(document.dispatchEvent(new CustomEvent("onSignUpSuccess",{detail:a})),p.default.success(t.$translate("Ceres::Template.regSuccessful")).closeAfter(3e3),null!==document.getElementById(t.modalElement)&&u.default.findModal(document.getElementById(t.modalElement)).hide(),null!==t.backlink&&t.backlink?Object(n.c)(decodeURIComponent(t.backlink)):location.reload()),t.isDisabled=!1})).fail((function(e){p.default.error(e.error).closeAfter(1e4),t.resetRecaptcha(),t.isDisabled=!1}))},resetRecaptcha:function(){if(2===App.config.global.googleRecaptchaVersion&&window.grecaptcha){var e=this.$refs.registrationForm.querySelector("[data-recaptcha]");window.grecaptcha.reset(e)}},setAddressDataField:function(e){var t=e.field,a=e.value;this.billingAddress[t]=a,this.billingAddress=Object.assign({},this.billingAddress)},getUserObject:function(){var e={contact:{referrerId:1,typeId:1,options:{typeId:{typeId:2,subTypeId:4,value:this.username,priority:0}}},honeypot:this.honeypot};return this.guestMode||(e.contact.password=this.password),this.isSimpleRegistration||(e.billingAddress=this.billingAddress),e},privacyPolicyValueChanged:function(e){this.privacyPolicyAccepted=e,e&&(this.privacyPolicyShowError=!1)},initModalEventListeners:function(){var e=this,t=u.default.findModal(document.getElementById(this.modalElement));Object(o.c)(t)&&(t.on("show.bs.modal",(function(){e.modalShown=!0})),t.on("hide.bs.modal",(function(){e.modalShown=!1})))}}},_=Object(v.a)(b,r,[],!1,null,null,null);_.options.__file="resources/js/src/app/components/customer/Registration.vue";t.default=_.exports}}]);
//# sourceMappingURL=ceres-client-17.min.js.map