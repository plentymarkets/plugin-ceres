{"version":3,"sources":["webpack:///resources/js/src/app/components/item/BKAvailability.vue","webpack:///./resources/js/src/app/components/item/BKAvailability.vue?d0c9","webpack:///./resources/js/src/app/components/item/BKAvailability.vue","webpack:///./resources/js/src/app/components/item/BKAvailability.vue?ef2f","webpack:///./resources/js/src/app/components/item/BKAvailability.vue?b495"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQA;AAEA;AACA,gCADA;AAGA,MAHA,kBAGA;AACA;AACA,8FADA;AAEA,8FAFA;AAGA,8FAHA;AAIA,gGAJA;AAKA,gGALA;AAMA,gGANA;AAOA,gGAPA;AAQA,kGARA;AASA,4GATA;AAUA,kGAVA;AAWA,gIAXA;AAYA,qHAZA;AAaA,wGAbA;AAcA,sGAdA;AAeA;AACA,kHAhBA;AAiBA,8GAjBA;AAkBA,qBAlBA;AAmBA;AAnBA;AAqBA,GAzBA;AA0BA;AACA;AACA;AADA,KADA;AAIA;AACA;AADA,KAJA;AAOA;AACA,mBADA;AAEA;AAFA;AAPA,GA1BA;AAuCA;AACA,2BADA,qCAEA;AAAA;;AACA,4BADA,CAGA;;AACA;AAAA;AAAA;AACA;AACA;AACA;;AAEA,8CACA;AACA;AACA,2BADA;AAEA;AAFA;AAIA;AACA;AACA;AACA;;AAEA;;AAEA,sEACA;AACA;AACA;AACA,uBADA;AAEA,uBAFA;AAGA,oDAHA;AAIA,6CACA;AACA;AACA,+BADA;AAEA;AAFA;AAIA;AACA;AACA;AACA;AAbA;AAeA;AACA;AA3CA,GAvCA;AAoFA;AACA,uBADA,iCACA;AAAA;;AACA;AACA,0BACA;;AAEA;AAEA;AAAA;AAAA,aAFA,CAIA;;AACA,6FACA;;AAEA;AACA;AACA;;AACA;AACA;;AACA;AACA;;AACA;AACA;;AACA;AACA;;AACA;AACA;;AACA;AACA;AACA;;AACA;AACA;AAjBA;AAmBA,OAhCA,CAkCA;AAEA;;;AACA;AACA;AACA;;AAEA;AAEA;AACA,uJACA;AAEA;AACA;AACA,wCACA;AAEA,+FAXA,CAaA;AACA;AACA;;AACA,6FACA,8CAjBA,CAmBA;AACA;AACA;;AACA,iCACA,kCAvBA,CAyBA;AACA;AACA;;AACA;AACA,OAtEA,CAwEA;AACA;AACA;;;AACA,mDA3EA,CA2EA;;AACA;AACA;AACA,4GA9EA,CA8EA;;AAEA;AACA;AAEA;AACA,qCApFA,CAsFA;;AACA,kEACA,4BAxFA,CA0FA;;AACA;AACA;AACA,KA9FA;AA+FA,oBA/FA,8BAgGA;AACA,4DACA,iDADA,IAEA,gDAFA,EAEA;AACA;AACA;;AACA;AACA,6HAPA,CASA;;AACA,uEACA;AAEA;AACA;AA9GA,GApFA;AAoMA,SApMA,qBAoMA;AAAA;;AACA;AACA,4CACA;;AACA;AACA,KAJA;AAKA,GA1MA;AA2MA;AACA,oCACA;AACA;AACA;AAJA;AA3MA,G;;;;;;;;;;;;ACVA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,oBAAoB,SAAS,kBAAkB,EAAE;AACjD;AACA,mBAAmB,uBAAuB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,mDAAmD;AACjE,iBAAiB;AACjB,KAAK;AACL;AACA;AACA;AACA;;;;;;;;;;;;;;ACpBA;AAAA;AAAA;AAAA;AAA6F;AAC3B;AACL;;;AAG7D;AACsG;AACtG,gBAAgB,2GAAU;AAC1B,EAAE,oFAAM;AACR,EAAE,yFAAM;AACR,EAAE,kGAAe;AACjB;AACA;AACA;AACA;;AAEA;;AAEA;AACA,IAAI,KAAU,EAAE,YAiBf;AACD;AACe,gF;;;;;;;;;;;;ACtCf;AAAA;AAAA,wCAAsM,CAAgB,kPAAG,EAAC,C;;;;;;;;;;;;ACA1N;AAAA;AAAA;AAAA;AAAA;AAAA","file":"chunks/ceres-31.js","sourcesContent":["<template>\n    <div :class=\"{'row': !short}\">\n        <div class=\"col-4\" v-if=\"!short\">{{ $translate(\"biokinderDesign::Template.itemAvailability\") }}</div>\n        <div :class=\"{ 'col-8': !short, 'liveShippingInfo': short }\" v-html=\"avDisplayHoliday\"></div>\n    </div>\n</template>\n\n<script>\nimport { isHoliday } from 'feiertagejs';\n\nexport default {\n    name: \"biokinder-availability\",\n\n    data() {\n      return {\n        txt1to3Days: this.$translate(\"biokinderDesign::Template.availabilityDisplayTxt1to3Days\"),\n        txt3to5Days: this.$translate(\"biokinderDesign::Template.availabilityDisplayTxt3to5Days\"),\n        txt5to8Days: this.$translate(\"biokinderDesign::Template.availabilityDisplayTxt5to8Days\"),\n        txt1to2Weeks: this.$translate(\"biokinderDesign::Template.availabilityDisplayTxt1to2Weeks\"),\n        txt2to4Weeks: this.$translate(\"biokinderDesign::Template.availabilityDisplayTxt2to4Weeks\"),\n        txt4to6Weeks: this.$translate(\"biokinderDesign::Template.availabilityDisplayTxt4to6Weeks\"),\n        txt6to8Weeks: this.$translate(\"biokinderDesign::Template.availabilityDisplayTxt6to8Weeks\"),\n        txt8to10Weeks: this.$translate(\"biokinderDesign::Template.availabilityDisplayTxt8to10Weeks\"),\n        txtDefaultDelivery: this.$translate(\"biokinderDesign::Template.availabilityDisplayTxtDefaultDelivery\"),\n        txtShipsToday: this.$translate(\"biokinderDesign::Template.availabilityDisplayTxtShipsToday\"),\n        txtChristmasHint: \"<span class='christmas'><i class='fa fa-gift' aria-hidden='true'></i> Pünktlich zu Weihnachten!</span>\",\n        txtEasterHint: \"<span class='easter'><i class='fa fa-gift' aria-hidden='true'></i> Pünktlich zu Ostern!</span>\",\n        txtShipsTomorrow: this.$translate(\"biokinderDesign::Template.availabilityDisplayTxtShipsTomorrow\"),\n        txtShipsMondays: this.$translate(\"biokinderDesign::Template.availabilityDisplayTxtShipsMondays\"),\n        // txtFrightShipsFriday: this.$translate(\"biokinderDesign::Template.availabilityDisplayTxtFrightShipsFriday\"),\n        txtFrightShipsTomorow: this.$translate(\"biokinderDesign::Template.availabilityDisplayTxtFrightShipsTomorow\"),\n        txtFrightNextFriday: this.$translate(\"biokinderDesign::Template.availabilityDisplayTxtFrightNextFriday\"),\n        isLoading: true,\n        requestLoading: false\n      }\n    },\n    props: {\n      variation: {\n        type: Object\n      },\n      avd: {\n        type: Object\n      },\n      short: {\n        type: Boolean,\n        default: false\n      }\n    },\n\n    methods: {\n      requestAvailabilityData()\n      {\n        this.isLoading = true;\n\n        // Already requested this variation\n        if (this.$store.erid.some((e) => { if (e && e.id == this.variation.id) return true; })) {\n            this.isLoading = false;\n            return;\n        }\n\n        if(this.variation.availabilityId == 1)\n        {\n            let avd = {\n                'id': variationId,\n                'd': 0\n            };\n            this.$store.erid.push(avd);\n            this.isLoading = false;\n            return;\n        }\n\n        let variationId = this.variation.id;\n\n        if(this.variation.availabilityId != 1 && !this.requestLoading)\n        {\n            this.requestLoading = true;\n            $.ajax({\n                method: 'GET',\n                context: this,\n                url: 'availabilities/' + variationId + '/',\n                success: function(intDays)\n                {\n                    let avd = {\n                        'id': variationId,\n                        'd': intDays\n                    };\n                    this.$store.erid.push(avd);\n                    this.requestLoading = false;\n                    this.isLoading = false;\n                }\n            });\n        } \n      }\n    },\n    computed: {\n        availabilityDisplay() {\n            // availability != 1\n            if(this.isLoading)\n                return \"...\";\n\n            if (this.variation.availability.id > 1) {\n\n                var tage = this.$store.erid.find((e) => { if (e && e.id == this.variation.id) return e; }).d;\n\n                // days not set properly\n                if (999 == tage || null == tage || 0 == tage || 5 != this.variation.availability.id)\n                    return this.variation.availability.names.name;\n\n                switch (!0) {\n                    case tage < 3:\n                        return this.txt1to3Days;\n                    case tage < 6:\n                        return this.txt3to5Days;\n                    case tage < 11:\n                        return this.txt5to8Days;\n                    case tage < 14:\n                        return this.txt1to2Weeks;\n                    case tage < 28:\n                        return this.txt2to4Weeks;\n                    case tage < 42:\n                        return this.txt4to6Weeks;\n                    case tage < 56:\n                    case tage < 70:\n                        return this.txt6to8Weeks;\n                    default:\n                        return this.txtDefaultDelivery\n                }\n            }\n\n            // availability = 1\n\n            // check for holidays\n            let dateTodayNow = new Date(1000 * this.avd.time.now);\n            let dateTomorrow = new Date(1000 * this.avd.time.now + 86400000);\n            let currentWeekDay = new Date(1000 * this.avd.time.now).getDay();\n\n            if (this.avd.isSped) {\n                \n                // today is friday before 10 and no holiday, ships today!\n                if(currentWeekDay == 5 && !isHoliday(dateTodayNow, \"HE\") && dateTodayNow.getHours() < 10)\n                    return this.txtShipsToday;\n\n                var nextFriday = new Date(this.avd.time.now * 1000);\n                var add = 0;\n                if (dateTodayNow.getDay() == 5)\n                    var add = 7;\n                \n                nextFriday.setDate(dateTodayNow.getDate() + ((5 + 7 - dateTodayNow.getDay()) % 7) + add);\n        \n                // today is friday after 10, or not friday or friday + holiday \n                // next friday is (also) a holiday \n                // lost -> show default value\n                if (isHoliday(nextFriday, \"HE\"))\n                    return this.variation.availability.names.name;\n                \n                // we now know, next friday is not a holiday\n                // we also know, it's thursday\n                // so we will ship tomorrow\n                if(currentWeekDay == 4)\n                    return this.txtFrightShipsTomorow;\n\n                // today is not friday or its friday and too late \n                // it is also not thursday\n                // next friday, shipping is possible. so output that.\n                return this.txtFrightNextFriday;\n            }\n\n            // product is available\n            // product is not freight\n            // check for holiday on monday\n            var daysUntilMonday = 8 - currentWeekDay % 7; // 8 - 5 % 7 = 3 --> friday + 3 days =) monday\n            var timestampMonday = 1000 * this.avd.time.now + 86400000 * daysUntilMonday;\n            let dateMonday = new Date(timestampMonday);\n            let mondayIsHoliday = isHoliday(dateMonday, \"HE\"); // <<--\n\n            if (this.avd.time.now < this.avd.time.until && currentWeekDay > 0 && currentWeekDay <= 5 && !isHoliday(dateTodayNow, \"HE\")) // mo - fr, 0 - ~14h\n                return this.txtShipsToday;\n\n            if (this.avd.time.now > this.avd.time.until && currentWeekDay > 0 && currentWeekDay <= 4 && !isHoliday(dateTomorrow, \"HE\")) // mo - do, 14 - 0\n                return this.txtShipsTomorrow;\n\n            // Friday afternoon, saturday, sunday 00:00 - 23:59 -> ships on monday\n            if ([5, 6, 0].includes(currentWeekDay) && !mondayIsHoliday)\n                return this.txtShipsMondays;\n\n            // if we forgot any case, default\n            console.info(\"BKAvailability\", \"default\");\n            return this.variation.availability.names.name;\n        },\n        avDisplayHoliday()\n        {\n            if (this.txtShipsToday != this.availabilityDisplay && \n                this.txtShipsTomorrow != this.availabilityDisplay && \n                this.txtShipsMondays != this.availabilityDisplay) {\n                return this.availabilityDisplay;\n            }\n            let dateTodayNow = new Date(1000 * this.avd.time.now);\n            const currentDayOfYear = Math.floor((dateTodayNow - new Date(dateTodayNow.getFullYear(), 0, 0)) / (1000 * 60 * 60 * 24));\n            \n            // Easter\n            if (dateTodayNow.getFullYear() == 2024 && currentDayOfYear < 87)\n                return \"<span>\" + this.availabilityDisplay + \"</span>\" + this.txtEasterHint;\n\n            return this.availabilityDisplay;\n        }\n    },\n    mounted() {\n        this.$nextTick(() => {\n            if (this.$store.erid === undefined)\n                this.$store.erid = [];\n            this.requestAvailabilityData()\n        });\n    },\n    watch: {\n      variation: function()\n      {\n          this.requestAvailabilityData()\n      }\n    }\n}\n</script>\n","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", { class: { row: !_vm.short } }, [\n    !_vm.short\n      ? _c(\"div\", { staticClass: \"col-4\" }, [\n          _vm._v(\n            _vm._s(_vm.$translate(\"biokinderDesign::Template.itemAvailability\"))\n          )\n        ])\n      : _vm._e(),\n    _vm._v(\" \"),\n    _c(\"div\", {\n      class: { \"col-8\": !_vm.short, liveShippingInfo: _vm.short },\n      domProps: { innerHTML: _vm._s(_vm.avDisplayHoliday) }\n    })\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./BKAvailability.vue?vue&type=template&id=b40fd004&\"\nimport script from \"./BKAvailability.vue?vue&type=script&lang=js&\"\nexport * from \"./BKAvailability.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/Users/schweser/GitHub/plentyDevTool/17831/40/Ceres/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('b40fd004')) {\n      api.createRecord('b40fd004', component.options)\n    } else {\n      api.reload('b40fd004', component.options)\n    }\n    module.hot.accept(\"./BKAvailability.vue?vue&type=template&id=b40fd004&\", function () {\n      api.rerender('b40fd004', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"resources/js/src/app/components/item/BKAvailability.vue\"\nexport default component.exports","import mod from \"-!../../../../../../node_modules/babel-loader/lib/index.js!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BKAvailability.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../node_modules/babel-loader/lib/index.js!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BKAvailability.vue?vue&type=script&lang=js&\"","export * from \"-!../../../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BKAvailability.vue?vue&type=template&id=b40fd004&\""],"sourceRoot":""}