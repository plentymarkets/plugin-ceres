(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{150:function(e,t,s){"use strict";function o(e,t,s,o,n,r,a,i){var c,u="function"==typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=s,u._compiled=!0),o&&(u.functional=!0),r&&(u._scopeId="data-v-"+r),a?(c=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},u._ssrRegister=c):n&&(c=i?function(){n.call(this,this.$root.$options.shadowRoot)}:n),c)if(u.functional){u._injectStyles=c;var l=u.render;u.render=function(e,t){return c.call(t),l(e,t)}}else{var p=u.beforeCreate;u.beforeCreate=p?[].concat(p,c):[c]}return{exports:e,options:u}}s.d(t,"a",(function(){return o}))},372:function(e,t,s){"use strict";s.r(t);var o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"search-box-inner w-100"},[s("div",{staticClass:"search-box-shadow-frame d-flex flex-grow-1 position-relative"},[s("input",{ref:"searchInput",staticClass:"search-input flex-grow-1 px-3 py-2",attrs:{type:"search",autofocus:e.isShopBuilder},on:{input:function(t){return e.autocomplete(t.target.value)},keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.prepareSearch()},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.keydown()},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:e.keyup()}],focus:function(t){e.isSearchFocused=!0},blur:function(t){return e.setIsSearchFocused(!1)}}}),e._v(" "),s("button",{staticClass:"search-submit px-3",attrs:{type:"submit"},on:{click:function(t){return e.search()}}},[s("i",{staticClass:"fa fa-search"})]),e._v(" "),e.isSearchFocused&&e.autocompleteResult.length?s("div",{staticClass:"autocomplete-suggestions"},e._l(e.autocompleteResult,(function(t,o){return s("div",{key:o,staticClass:"autocomplete-suggestion",class:{"autocomplete-selected":e.selectedAutocompleteIndex===o},on:{mousedown:function(s){return e.selectAutocompleteItem(t)}}},[e.showItemImages?s("div",{staticClass:"autocomplete-image-container"},[s("img",{staticClass:"autocomplete-image",attrs:{src:t.img}})]):e._e(),e._v(" "),s("div",{staticClass:"autocomplete-item-name",domProps:{innerHTML:e._s(t.displayName)}})])})),0):e._e()])])};o._withStripped=!0;s(10),s(13),s(15),s(69),s(8),s(46),s(5),s(16),s(11),s(51),s(154),s(40),s(9);var n=s(27),r=s(1),a=s(54),i=s(14),c={name:"item-search",props:{showItemImages:{type:Boolean,default:!1},forwardToSingleItem:{type:Boolean,default:App.config.search.forwardToSingleItem}},data:function(){return{autocompleteRequest:null,autocompleteResult:[],selectedAutocompleteIndex:-1,isSearchFocused:!1}},computed:{selectedAutocompleteItem:function(){var e=this.autocompleteResult[this.selectedAutocompleteIndex];return this.selectedAutocompleteIndex<0||!e?null:e},isShopBuilder:function(){return App.isShopBuilder}},mounted:function(){var e=this;this.$nextTick((function(){var t=n.a.getUrlParams(document.location.search);e.$store.commit("setItemListSearchString",t.query),e.$refs.searchInput.value=Object(r.d)(t.query)?"":t.query}))},methods:{prepareSearch:function(){this.selectedAutocompleteItem?this.forwardToSingleItem?window.open(this.selectedAutocompleteItem.url,"_self",!1):(this.$refs.searchInput.value=this.selectedAutocompleteItem.name,this.$store.commit("setItemListSearchString",this.$refs.searchInput.value),this.search()):this.search(),$("#searchBox").collapse("hide")},search:function(){this.$refs.searchInput.value.length?Object(a.b)(App.urls.search)?(this.updateTitle(this.$refs.searchInput.value),this.$store.dispatch("searchItems",this.$refs.searchInput.value),this.selectedAutocompleteIndex=-1,this.autocompleteResult=[]):window.open("".concat(App.urls.search,"?query=").concat(this.$refs.searchInput.value),"_self",!1):this.preventSearch=!1},updateTitle:function(e){var t=document.querySelector("#searchPageTitle"),s=this.$translate("Ceres::Template.itemSearchResults")+" "+e;Object(r.d)(t)||(t.innerHTML="",t.appendChild(document.createTextNode(s))),document.title="".concat(s," | ").concat(this.$translate("Ceres::Template.headerCompanyName"))},autocomplete:function(e){var t=this;e.length>=2?(Object(r.d)(this.autocompleteRequest)||"function"!=typeof this.autocompleteRequest.abort||this.autocompleteRequest.abort(),this.autocompleteRequest=i.default.get("/rest/io/item/search/autocomplete",{template:"Ceres::ItemList.Components.ItemSearch",query:e}),this.autocompleteRequest.done((function(s){if(t.autocompleteRequest=null,t.autocompleteResult=[],t.selectedAutocompleteIndex=-1,s&&s.documents.length){var o=!0,n=!1,r=void 0;try{for(var a,i=s.documents[Symbol.iterator]();!(o=(a=i.next()).done);o=!0){var c=a.value,u=t.$options.filters.itemImages(c.data.images,"urlPreview"),l=t.$options.filters.itemImage(u),p=t.$options.filters.itemURL(c.data),h=t.$options.filters.itemName(c.data),m=h,d=!0,f=!1,v=void 0;try{for(var I,y=e.split(" ")[Symbol.iterator]();!(d=(I=y.next()).done);d=!0){var g=I.value;m=m.replace(g,"<strong>".concat(g,"</strong>"))}}catch(e){f=!0,v=e}finally{try{d||null==y.return||y.return()}finally{if(f)throw v}}t.autocompleteResult.push({img:l,url:p,name:h,displayName:m})}}catch(e){n=!0,r=e}finally{try{o||null==i.return||i.return()}finally{if(n)throw r}}}}))):this.autocompleteResult=[]},selectAutocompleteItem:function(e){this.forwardToSingleItem?window.open(e.url,"_self",!1):(this.$refs.searchInput.value=e.name,this.$store.commit("setItemListSearchString",this.$refs.searchInput.value),this.search())},keyup:function(){this.selectedAutocompleteIndex--,this.selectedAutocompleteIndex<0&&(this.selectedAutocompleteIndex=0)},keydown:function(){this.selectedAutocompleteIndex++,this.selectedAutocompleteIndex>this.autocompleteResult.length-1&&(this.selectedAutocompleteIndex=this.autocompleteResult.length-1)},setIsSearchFocused:function(e){var t=this;setTimeout((function(){t.isSearchFocused=!!e}),100)}}},u=s(150),l=Object(u.a)(c,o,[],!1,null,null,null);l.options.__file="resources/js/src/app/components/itemList/ItemSearch.vue";t.default=l.exports}}]);
//# sourceMappingURL=ceres-37.min.js.map