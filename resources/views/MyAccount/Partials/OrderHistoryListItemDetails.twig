{% import "Ceres::PageDesign.Macros.LayoutContainer" as LayoutContainer %}

{% set basketTotalsCurrency = totals.currency %}
<div>
    <div class="row container_middle border">
        <div class="col-md-7 products border">
            <div class="row">
                <div class="col-sm-12 item py-3">
                    <img class="d-inline-block" src="https://cdn02.plentymarkets.com/jpx0tvae1136/item/images/107/full/107-Barhocker-Fury-gepolstert.jpg">
                    <div class="d-inline-block item-description">
                        <div><a class="text-primary" href="https://cdn02.plentymarkets.com/jpx0tvae1136/item/images/107/full/107-Barhocker-Fury-gepolstert.jpg">Barhocker White SanFrancisco</a></div>
                        <div>Einzelpreis: 149,00 EUR</div>
                        <div>St체ckzahl: 1</div>
                        <div>Gesamt: 149,00 EUR</div>
                    </div>
                </div>
                <div class="col-sm-12 item py-3">
                    <img class="d-inline-block" src="https://cdn02.plentymarkets.com/jpx0tvae1136/item/images/107/full/107-Barhocker-Fury-gepolstert.jpg">
                    <div class="d-inline-block item-description">
                        <div><a class="text-primary" href="https://cdn02.plentymarkets.com/jpx0tvae1136/item/images/107/full/107-Barhocker-Fury-gepolstert.jpg">Barhocker White SanFrancisco</a>
                        <br>Einzelpreis: 149,00 EUR
                        <br>St체ckzahl: 1
                        <br>Gesamt: 149,00 EUR</div>
                    </div>
                </div>
                <div class="col-sm-12 item py-3">
                    <img class="d-inline-block" src="https://cdn02.plentymarkets.com/jpx0tvae1136/item/images/107/full/107-Barhocker-Fury-gepolstert.jpg">
                    <div class="d-inline-block item-description">
                        <div><a class="text-primary" href="https://cdn02.plentymarkets.com/jpx0tvae1136/item/images/107/full/107-Barhocker-Fury-gepolstert.jpg">Barhocker White SanFrancisco</a></div>
                        <div>Einzelpreis: 149,00 EUR</div>
                        <div>St체ckzahl: 1</div>
                        <div>Gesamt: 149,00 EUR</div>
                    </div>
                </div>
            </div>
            <div class="row mb-2"><div class="col-sm-12 text-center "><a class="text-primary" href="#">Alles anzeigen</a></div></div>
        </div>
        <div class="col-md-5 sum">
            <div class="cmp cmp-totals row pt-3">
                <div class="col-sm-12">
                    <h3>{{ trans("Ceres::Template.orderHistorySum") }}</h3>
                    <div>
                        <dl>
                            <dt{% if orderData.highlightNetPrices %} class="font-weight-bold"{% endif %}>
                                {{ trans("Ceres::Template.orderHistoryValue") }} ({{ trans("Ceres::Template.orderHistoryNet") }})
                            </dt><!--
                        --><dd{% if orderData.highlightNetPrices %} class="font-weight-bold"{% endif %}>
                                {{ (totals.itemSumNet + rebatedAmountTotalNet) | formatMonetary( basketTotalsCurrency ) }}
                            </dd>
    
                            <dt{% if not orderData.highlightNetPrices %} class="font-weight-bold"{% endif %}>
                                {{ trans("Ceres::Template.orderHistoryValue") }} ({{ trans("Ceres::Template.orderHistoryGross") }})
                            </dt><!--
                        --><dd{% if not orderData.highlightNetPrices %} class="font-weight-bold"{% endif %}>
                                {% if orderData.order.amounts[0].isNet %}
                                    {{ (totals.itemSumGross + rebatedAmountTotalNet) | formatMonetary( basketTotalsCurrency ) }}
                                {% else %}
                                    {{ (totals.itemSumGross + rebatedAmountTotalGross) | formatMonetary( basketTotalsCurrency ) }}
                                {% endif %}
                            </dd>
                            {% if rebatedAmountTotal > 0 %}
                                <dt class="rebate-hint">
                                    {{ trans("Ceres::Template.orderHistoryRebate") }}
                                </dt><!--
                                --><dd class="rebate-hint">
                                {{ rebatedAmountTotal| formatMonetary( basketTotalsCurrency ) }}
                            </dd>
                                <dt {% if orderData.highlightNetPrices %} class="font-weight-bold"{% endif %}>
                                    {{ trans("Ceres::Template.orderHistorySubTotal") }} ({{ trans("Ceres::Template.orderHistoryNet") }})
                                </dt><!--
                                --><dd {% if orderData.highlightNetPrices %} class="font-weight-bold"{% endif %}>
                                {{ totals.itemSumNet | formatMonetary( basketTotalsCurrency ) }}
                            </dd>
                                <dt {% if not orderData.highlightNetPrices %} class="font-weight-bold"{% endif %}>
                                    {{ trans("Ceres::Template.orderHistorySubTotal") }} ({{ trans("Ceres::Template.orderHistoryGross") }})
                                </dt><!--
                                --><dd {% if not orderData.highlightNetPrices %} class="font-weight-bold"{% endif %}>
                                {{ totals.itemSumGross | formatMonetary( basketTotalsCurrency ) }}
                            </dd>
                            {% endif %}
                            <dt{% if orderData.highlightNetPrices %} class="font-weight-bold"{% endif %}>
                                {{ trans("Ceres::Template.orderHistoryShippingCosts") }} ({{ trans("Ceres::Template.orderHistoryNet") }})
                            </dt><!--
                        --><dd{% if orderData.highlightNetPrices %} class="font-weight-bold"{% endif %}>
                                {{ totals.shippingNet | formatMonetary( basketTotalsCurrency ) }}
                            </dd>
                            <dt{% if not orderData.highlightNetPrices %} class="font-weight-bold"{% endif %}>
                                {{ trans("Ceres::Template.orderHistoryShippingCosts") }} ({{ trans("Ceres::Template.orderHistoryGross") }})
                            </dt><!--
                        --><dd{% if not orderData.highlightNetPrices %} class="font-weight-bold"{% endif %}>
                                {{ totals.shippingGross | formatMonetary( basketTotalsCurrency ) }}
                            </dd>
    
                            <hr>
    
                            {% set grossNet = LayoutContainer.show("Ceres::OrderConfirmation.GrossNetReplace", orderData.order) %}
                            {% if grossNet|trim is not empty %}
                                {{ grossNet }}
                            {% else %}
                                <dt{% if orderData.highlightNetPrices %} class="font-weight-bold"{% endif %}>
                                    {{ trans("Ceres::Template.orderHistoryTotalSum") }} ({{ trans("Ceres::Template.orderHistoryNet") }})
                                </dt><!--
                                --><dd{% if orderData.highlightNetPrices %} class="font-weight-bold"{% endif %}>
                                {{ totals.totalNet | formatMonetary( basketTotalsCurrency ) }}
                            </dd>
    
                                {% if totals.couponType == 'promotional' and (totals.couponValue | trimNewlines) != 0 %}
                                    <dt{% if not orderData.highlightNetPrices %} class="font-weight-bold"{% endif %}>
                                        {{ trans("Ceres::Template.orderHistoryCoupon") }}
                                    </dt><!--
                                    --><dd{% if not orderData.highlightNetPrices %} class="font-weight-bold"{% endif %}>
                                    {{ totals.couponValue | formatMonetary( basketTotalsCurrency ) }}
                                </dd>
                                {% endif %}
    
                                {% if not orderData.order.amounts[0].isNet %}
                                    <div class="vatTotals">
                                        {% for vat in totals.vats %}
                                            <dt>
                                                {{ trans("Ceres::Template.orderHistoryVAT") }} {{ vat.rate }}%
                                            </dt><!--
                                            --><dd>
                                                {{ vat.value | formatMonetary( basketTotalsCurrency ) }}
                                            </dd>
                                        {% endfor %}
                                    </div>
                                {% endif %}
    
                                <div class="totalSum">
                                    <hr>
                                    <dt{% if not orderData.highlightNetPrices %} class="font-weight-bold"{% endif %}>
                                        {{ trans("Ceres::Template.orderHistoryTotalSum") }} ({{ trans("Ceres::Template.orderHistoryGross") }})
                                    </dt><!--
                                    --><dd{% if not orderData.highlightNetPrices %} class="font-weight-bold"{% endif %}>
                                        {{ totals.totalGross | formatMonetary( basketTotalsCurrency ) }}
                                    </dd>
                                </div>
                            {% endif %} <!-- GrossNetReplace|else -->
                            {% if totals.couponType == 'sales' and (totals.couponValue | trimNewlines) != 0 %}
                                <dt>
                                    {{ trans("Ceres::Template.orderHistoryCoupon") }}
                                </dt><!--
                                      --><dd>
                                {{ totals.couponValue | formatMonetary( basketTotalsCurrency ) }}
                            </dd>
                                <dt>
                                    <strong>{{ trans("Ceres::Template.orderHistoryOpenAmount") }}</strong>
                                </dt><!--
                                        --><dd>
                                <strong>{{ totals.openAmount | formatMonetary( basketTotalsCurrency ) }}</strong>
                            </dd>
                            {% endif %}
                            {{ LayoutContainer.show("Ceres::OrderConfirmation.AfterTotals", orderData.order) }}
                        </dl>
                    </div>
                </div>
            </div>



        </div>
    </div>

    <div class="row container_bottom border py-4">
        <div class="col-md-7">
            <div class="row">
                <div class="col-sm-4">                            
                    <p>
                        <strong>{{ trans("Ceres::Template.orderHistoryPaymentMethod") }}</strong>
                        <br>
                        <span id="payment_name_{{ orderData.order.id }}">{{ orderData.paymentMethodName }}</span>
                    </p>
                    <p>
                        <strong>{{ trans("Ceres::Template.orderHistoryPaymentStatus") }}</strong>
                        <br>
                        {% set paymentMethodId = -1 %}
                        {% for propertyKey in orderData.order.properties %}
                            {% if orderData.order.properties[loop.index0].typeId == 4 %}
                                {% set paymentStatus = entry.order.properties[loop.index0].value %}
                                <span id="payment_state_{{ orderData.order.id }}">{{ trans("Ceres::Template.orderHistoryPaymentStatus_" ~ orderData.order.properties[loop.index0].value) }}</span>
                            {% elseif orderData.order.properties[loop.index0].typeId == 3 %}
                                {% set paymentMethodId = orderData.order.properties[loop.index0].value %}
                            {% endif %}
                        {% endfor %}
                    </p>
                    <p><strong>{{ trans("Ceres::Template.orderHistoryShippingProfile") }}</strong><br>{{ orderData.shippingProvider }} - {{ orderData.shippingProfileName }}</p>
                </div>
                <div class="col-sm-8">
                    <div class="row">
                        <div class="col-sm-6">
                            <h5 class="mb-3"><strong>{{ trans("Ceres::Template.orderHistoryInvoiceAddress") }}</strong></h5>
                            <address-header :address="{{ orderData.order.billingAddress | json_encode }}"></address-header>
                        </div>
                        <div class="col-sm-6">
                            <h5 class="mb-3"><strong>{{ trans("Ceres::Template.orderHistoryShippingAddress") }}</strong></h5>
                            <address-header :address="{{orderData.order.deliveryAddress | json_encode }}"></address-header>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-5">
            {# <a href="#" class="btn btn-primary btn-block">Zahlungs채nderung<i class="fa fa-pencil-square-o" aria-hidden="true"></i></a> #}
            <change-payment-method
                template="#vue-change-payment-method"
                :current-order="{{ orderData.order | json_encode }}"
                :change-possible="{{ orderData.allowPaymentMethodSwitchFrom | json_encode }}"
                :allowed-payment-methods="{{ orderData.paymentMethodListForSwitch | json_encode }}"
                :payment-status="{{ orderData.paymentStatus | json_encode }}"
                current-template="tpl.my-account"
                :current-payment-method-name="{{ orderData.paymentMethodName | json_encode }}">
            </change-payment-method>
            {{ LayoutContainer.show("Ceres::MyAccount.OrderHistoryPaymentInformation", orderData.order) }}
            
            {% if orderData.isReturnable %}
                <a v-waiting-animation-infinite class="btn btn-primary btn-block" href="/returns/{{ orderData.order.id }}">
                    <i class="fa fa-repeat" aria-hidden="true"></i>
                    {{ trans("Ceres::Template.orderHistoryReturnSendBack") }}
                </a>
            {% endif %}
            
            <order-documents :documents="{{ orderData.order.documents | json_encode }}"></order-documents>
        </div>
    </div>
</div>
